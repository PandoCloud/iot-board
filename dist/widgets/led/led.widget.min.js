/*! iot-board 2015-06-30 */
!function(){return window.iotboard?(window.iotboard.defineWidget("led",{status:{red:255,green:255,blue:255,freq:100,white:100},render:function(a){return(a.title?'<div class="title">'+a.title+"</div>":"")+'<div class="colorpicker"><canvas class="picker" width="200" height="200"></canvas></div><div class="preview"><div><label>R</label> <input type="text" class="rPrev" style="background-color:#'+this.status.red.toString(16)+'0000"/></div><div><label>G</label> <input type="text" class="gPrev" style="background-color:#00'+this.status.red.toString(16)+'00"/></div><div><label>B</label> <input type="text" class="bPrev" style="background-color:#0000'+this.status.red.toString(16)+'"/></div></div><div class="clf"></div><div class="controls"><input type="hidden" class="rVal" value="'+this.status.red+'"/><input type="hidden" class="gVal" value="'+this.status.green+'"/><input type="hidden" class="bVal" value="'+this.status.blue+'"/><div><label>Freq(<span class="freqVal">'+this.status.freq+'</span>)</label><input type="range" class="freqCtrl" min="1" max="1000" value="'+this.status.freq+'"/></div><div><label>W(<span class="wVal">'+this.status.white+'</span>)</label><input type="range" class="wCtrl" min="0" max="255" value="'+this.status.white+'"/></div></div><div class="btn btn-refresh">REFRESH</div><div class="btn btn-set">SET</div><div class="clf"></div>'},listeners:[{selector:".btn-refresh",event:"click",behavior:"get"},{selector:".btn-set",event:"click",behavior:"set"}],parseStatus:function(a){return{red:parseInt(a.find(".rVal").val()),green:parseInt(a.find(".gVal").val()),blue:parseInt(a.find(".bVal").val()),freq:parseInt(a.find(".freqVal").text()),white:parseInt(a.find(".wVal").text())}},onRendered:function(a){console.log("on widget rendered."),a.find(".picker").each(function(){var a=this.getContext("2d"),b=new Image;b.onload=function(){console.log("color picker loaded..."),a.drawImage(b,0,0)};var c="widgets/led/colorwheel.png";b.src=c}),a.find(".picker").on("click",function(a){var b=$(this).closest(".widget"),c=this.getContext("2d"),d=$(this).offset(),e=Math.floor(a.pageX-d.left),f=Math.floor(a.pageY-d.top),g=c.getImageData(e,f,1,1),h=g.data;b.find(".rPrev").css("background-color","#"+h[0].toString(16)+"0000"),b.find(".gPrev").css("background-color","#00"+h[1].toString(16)+"00"),b.find(".bPrev").css("background-color","#0000"+h[2].toString(16)),b.find(".rVal").val(h[0]),b.find(".gVal").val(h[1]),b.find(".bVal").val(h[2])}),a.find(".freqCtrl").change(function(){$(this).closest(".controls").find(".freqVal").text($(this).val())}),a.find(".wCtrl").change(function(){$(this).closest(".controls").find(".wVal").text($(this).val())})}}),void console.log("add widget {led}")):void console.log("iotboard not initialized!")}();